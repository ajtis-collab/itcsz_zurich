<!doctype html>
<html lang="zh">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>苏黎世分站赛决赛 ITCSZ Zurich Finale</title>
  <style>
    /* ===== 颜色主题（贴近你截图的风格） ===== */
    :root{
      --bg:#f6f7fb;          /* 页面浅灰背景 */
      --card:#ffffff;        /* 卡片白色 */
      --border:#e5e7eb;      /* 边框/分割线 */
      --shadow:0 10px 24px rgba(17,24,39,.08);

      --text:#111827;        /* 主文字深灰 */
      --muted:#6b7280;       /* 次级文字 */
      --heading:#0f172a;     /* 标题深蓝 */

      --primary:#c0147b;     /* 品牌洋红（按钮/高亮） */
      --primary-600:#a01164; /* hover 深色 */
      --primary-50:#fde7f3;  /* 浅色背景（focus/选中） */

      --accent:#0ea5e9;      /* 次要点缀（可用于链接） */
      --ok:#10b981;
      --warn:#f59e0b;
      --err:#ef4444;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans","PingFang SC","Microsoft YaHei",sans-serif;
      background:var(--bg);
      color:var(--text);
      display:flex; align-items:flex-start; justify-content:center;
      padding:40px 20px;
    }

    /* 顶部左侧 LOGO */
    .logo{
      position:fixed; top:18px; left:22px;
      width:240px; height:auto;
      opacity:.9;
      z-index:9999;
      pointer-events:none;     /* 不遮挡点击 */
      transition:opacity .25s ease;
    }
    .logo:hover{ opacity:1; }

    /* 布局 */
    .wrap{ width:100%; max-width:980px; margin-top: 60px; }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:18px;
      box-shadow:var(--shadow);
      padding:28px;
    }

    h1{
      margin:0 0 6px;
      font-size:28px;
      color:var(--heading);
      letter-spacing:.2px;
    }
    .sub{ color:var(--muted); margin-bottom:18px; font-size:14px }

    /* 搜索区 */
    .search{ position:relative; display:flex; gap:12px; align-items:center }
    .search input{
      flex:1;
      padding:14px 16px;
      border-radius:12px;
      border:1px solid var(--border);
      background:#fff;
      color:var(--text);
      font-size:16px;
      outline:none;
      transition:border-color .15s, box-shadow .15s;
    }
    .search input:focus{
      border-color:var(--primary);
      box-shadow:0 0 0 3px var(--primary-50);
    }
    .search button{
      padding:12px 18px;
      border-radius:12px;
      border:0;
      background:var(--primary);
      color:#fff;
      font-weight:700;
      letter-spacing:.2px;
      cursor:pointer;
      transition:filter .15s, background .15s, transform .02s;
      box-shadow:0 6px 16px rgba(192,20,123,.25);
    }
    .search button:hover{ background:var(--primary-600) }
    .search button:active{ transform:translateY(1px) }

    .hint{ color:var(--muted); font-size:12px; margin-top:8px }

    /* 下拉候选（明亮风格） */
    .dropdown{
      position:absolute; top:100%; left:0; right:0; z-index:50;
      margin-top:8px;
      background:#fff;
      border:1px solid var(--border);
      border-radius:12px;
      overflow:hidden;
      max-height:280px; overflow-y:auto;
      display:none;
      box-shadow:var(--shadow);
    }
    .dropdown.visible{ display:block }
    .opt{
      padding:10px 14px;
      cursor:pointer;
      border-bottom:1px solid var(--border);
    }
    .opt:last-child{ border-bottom:none }
    .opt:hover, .opt.active{
      background:#fff1f8;              /* 洋红的浅背景 */
    }

    /* 结果区 */
    .result{ margin-top:18px; display:none }
    .row{ display:flex; gap:10px; flex-wrap:wrap }
    .pill{
      background:#f9fafb;
      border:1px solid var(--border);
      color:#374151;
      border-radius:999px;
      padding:8px 12px; font-size:13px
    }
    .score{
      margin-top:14px;
      font-size:42px; font-weight:850; letter-spacing:.2px;
      color:var(--primary);             /* 分数用品牌色 */
    }

    /* 加载器 */
    .loader{ display:none; margin-top:18px; align-items:center; gap:10px }
    .spinner{
      width:18px; height:18px; border-radius:50%;
      border:3px solid rgba(192,20,123,.15); border-top-color:var(--primary);
      animation:spin 1s linear infinite;
    }
    @keyframes spin{to{transform:rotate(360deg)}}

    .err{ color:var(--err); margin-top:10px }
    .footer{ margin-top:22px; color:var(--muted); font-size:12px }
    .kbd{
      border:1px solid var(--border); border-bottom-width:2px;
      padding:1px 6px; border-radius:6px; background:#fff; color:#374151
    }

    @media (max-width:520px){
      body{ padding-top:80px }          /* 给固定 logo 留空间 */
      h1{ font-size:24px }
      .score{ font-size:36px }
    }
  </style>
</head>
<body>
  <!-- 左上角 LOGO（透明 PNG） -->
  <img src="itcsz_logo.png" alt="logo" class="logo" />

  <div class="wrap">
    <div class="card">
      <h1>苏黎世分站赛决赛路演编号抽签<br>
          ITCSZ Zurich Division Final Roadshow Order Draw
      </h1>
      <div class="sub">
        输入或选择姓名(汉语拼音)，点击“抽取编号”。Please enter or choose your name and click "Draw"
      </div>

      <div class="search" role="search">
        <input id="nameInput" type="text" placeholder="例如：Zhang San / José García" autocomplete="off" aria-autocomplete="list" aria-haspopup="listbox" aria-expanded="false" />
        <button id="searchBtn" type="button">抽取编号 Draw a number </button>
        <div id="dropdown" class="dropdown" role="listbox" aria-label="姓名候选列表"></div>
      </div>
      <div class="hint">提示：键入 2 个以上字符将出现候选；可用 <span class="kbd">↑</span> <span class="kbd">↓</span> 选择，<span class="kbd">Enter</span> 确认。</div>

      <div id="loader" class="loader" aria-live="polite">
        <div class="spinner" aria-hidden="true"></div>
        <div class="muted">正在加载，请稍候 Loading…</div>
      </div>

      <div id="error" class="err" role="alert"></div>

      <div id="result" class="result" aria-live="polite">
        <div id="who" class="row"></div>
        <div id="score" class="score"></div>
        <div id="meta" class="row" style="margin-top:10px;"></div>
      </div>

      
      <br><br><br>
      
      
      
      
      
      <div class="note">
        <p><b>说明 / Note:</b></p>
        <p>
          为确保路演顺序兼具公平性与行业聚合性，现制定如下排序规则：<br>
          一、抽签机制<br>
          每个参赛项目通过随机抽签方式获得唯一编号（以下简称“抽签号”），取值范围为1至21。该编号仅用于确定行业及项目的展示顺序，不直接代表最终路演顺序。<br>
          二、行业（赛道）排序原则<br>
          1. 按抽签号从小到大依次检视各项目所属行业；<br>
          2. 当某一行业首次出现时，将其记录于“行业顺序列表”中；<br>
          3. 若该行业此前已出现，则跳过不再新增；<br>
          4. 依次遍历全部项目后，所得行业出现次序即为 各行业（赛道）的展示顺序。<br>
          换言之，首个出现的行业列为第一赛道，第二个首次出现的新行业列为第二赛道，以此类推，直至所有行业均确定展示顺序。<br>
          三、行业内项目排序原则<br>
          在同一行业（赛道）内，项目依其抽签号由小到大排序，抽签号较小者优先路演。<br>
          四、最终路演顺序生成规则<br>
          最终的21个项目路演顺序按以下方式确定：<br>
          1. 先依据第二部分所确立的行业展示顺序排列赛道；<br>
          2. 在各赛道内部，再按第三部分的项目顺序进行排列；<br>
          3. 依此组合形成完整的、具有行业聚合性的最终路演顺序。<br>
        </p>
        <p>
          To ensure that the presentation sequence balances fairness and industry coherence, the following procedure governs the determination of the final order:<br>
            1. Drawing Procedure<br>
            Each participating project draws a unique random number (hereinafter referred to as the “draw number”), ranging from 1 to 21.<br>
            The draw number serves solely for determining the track and project order, and does not directly represent the final presentation position.<br>
            2. Track Ordering Principle<br>
            1. All projects are first sorted in ascending order of their draw numbers.<br>
            2. As the list is traversed, whenever a new track (industry category) appears for the first time, it is recorded in the Track Order List.<br>
            3. If the track has appeared previously, it is skipped.<br>
            4. After completing the traversal, the order in which new tracks first appear defines the sequence of track presentations.<br>
            In other words, the first track encountered ranks first, the second new track ranks second, and so on, until all seven tracks are assigned an order.<br>
            3. Within-Track Ordering Principle<br>
            Within each track, projects are ordered in ascending order of their draw numbers, such that projects with smaller numbers present earlier.<br>
            4. Final Presentation Order<br>
            The complete presentation order of the 21 projects is determined as follows:<br>
            1. Arrange all tracks according to the order established in Section 2;<br>
            2. Within each track, arrange projects as specified in Section 3;<br>
            3. The concatenation of these ordered sequences yields the final presentation order, ensuring both randomness and track coherence.<br>
        </p>
        <p>
          感谢所有参赛团队的参与与支持，祝各位选手取得优异成绩！
        <br>
          Thank you for your participation, and wish you a successful presentation!
        </p>
      </div>    
      <br><br><br>
      <div class="footer">Copyright 2015 - 2025 © China（Shenzhen）Innovation & Entrepreneurship International Competition, All Rights Reserved. 粤ICP备17148765号</div>
    </div>
  </div>

  <!-- 数据文件 -->
  <script src="data.js"></script>
  <script>
    // —— 工具：去除重音与全角，统一小写以便无差异匹配 ——
    const strip = (s) => (s||"")
      .toString()
      .normalize('NFD').replace(/[\u0300-\u036f]/g,'')   // 去重音
      .replace(/[Ａ-Ｚａ-ｚ０-９]/g, ch =>               // 全角转半角
        String.fromCharCode(ch.charCodeAt(0)-0xFEE0))
      .toLowerCase().trim();

    // 数据预处理：displayName 与 searchKey
    const people = (window.DATA || []).map(x=>{
      const first = (x.firstName||"").trim();
      const last  = (x.lastName ||"").trim();
      const displayName = [first,last].filter(Boolean).join(' ') || x.name || "";
      const searchKey = strip(displayName);
      return {...x, displayName, searchKey};
    });

    // 快速索引
    const byName = new Map();
    people.forEach(p=> byName.set(p.displayName, p));

    // DOM
    const $input   = document.getElementById('nameInput');
    const $drop    = document.getElementById('dropdown');
    const $btn     = document.getElementById('searchBtn');
    const $loader  = document.getElementById('loader');
    const $error   = document.getElementById('error');
    const $result  = document.getElementById('result');
    const $who     = document.getElementById('who');
    const $score   = document.getElementById('score');
    const $meta    = document.getElementById('meta');

    let activeIndex = -1;
    let currentList = [];

    function renderDropdown(list){
      $drop.innerHTML = '';
      if(!list.length){
        $drop.classList.remove('visible');
        $input.setAttribute('aria-expanded','false');
        return;
      }
      list.forEach((p,i)=>{
        const opt = document.createElement('div');
        opt.className = 'opt' + (i===activeIndex ? ' active' : '');
        opt.setAttribute('role','option');
        opt.setAttribute('tabindex','-1');
        opt.textContent = p.displayName;
        opt.addEventListener('mousedown', e => {
          e.preventDefault(); choose(p.displayName);
        });
        $drop.appendChild(opt);
      });
      $drop.classList.add('visible');
      $input.setAttribute('aria-expanded','true');
    }

    function updateDropdown(){
      const q = strip($input.value);
      activeIndex = -1;
      if(q.length < 2){ renderDropdown([]); return; }
      currentList = people.filter(p => p.searchKey.includes(q)).slice(0, 50);
      renderDropdown(currentList);
    }

    function choose(name){
      $input.value = name;
      $drop.classList.remove('visible');
      $input.setAttribute('aria-expanded','false');
      search();
    }

    function showLoader(on){ $loader.style.display = on ? 'flex' : 'none'; }
    function showError(msg){ $error.textContent = msg || ''; }
    function showResult(p){
      if(!p){ $result.style.display='none'; return; }
      $who.innerHTML = '';
      const badge = (txt)=>{ const b=document.createElement('div'); b.className='pill'; b.textContent=txt; return b; };

      $who.appendChild(badge(p.displayName));
      if(p.age!==undefined) $who.appendChild(badge(`年龄 ${p.age}`));

      const scoreText = (p.score!==undefined && p.score!==null) ? `路演顺序：${p.score}` : '顺序未抽取';
      $score.textContent = scoreText;

      $meta.innerHTML = '';
      if(p.project) $meta.appendChild(badge(`项目：${p.project}`));
      if(p.track)   $meta.appendChild(badge(`Track：${p.track}`));
      $result.style.display='block';
    }

    function search(){
      showError('');
      showResult(null);
      const name = $input.value.trim();
      if(!name){ showError('请先选择或输入姓名'); return; }

      let person = byName.get(name);
      if(!person){
        const key = strip(name);
        person = people.find(p => p.searchKey === key) || people.find(p => p.searchKey.includes(key));
      }
      if(!person){ showError('未找到该姓名，请从下拉候选中选择（避免中英文/重音差异）'); return; }

      showLoader(true);
      $btn.disabled = true; $input.disabled = true;
      setTimeout(()=>{
        showLoader(false);
        showResult(person);
        $btn.disabled = false; $input.disabled = false; $input.focus();
      }, 2000);
    }

    // 事件绑定
    $input.addEventListener('input', updateDropdown);
    $input.addEventListener('focus', updateDropdown);
    $input.addEventListener('blur', ()=>setTimeout(()=>{$drop.classList.remove('visible'); $input.setAttribute('aria-expanded','false');},150));
    $input.addEventListener('keydown', (e)=>{
      const visible = $drop.classList.contains('visible');
      if(visible && (e.key==='ArrowDown' || e.key==='ArrowUp')){
        e.preventDefault();
        const max = currentList.length-1; if(max<0) return;
        if(e.key==='ArrowDown') activeIndex = Math.min(max, activeIndex+1);
        else activeIndex = Math.max(0, activeIndex-1);
        Array.from($drop.children).forEach((el,i)=> el.classList.toggle('active', i===activeIndex));
      }else if(e.key==='Enter'){
        e.preventDefault();
        if(visible && activeIndex>=0 && currentList[activeIndex]){
          choose(currentList[activeIndex].displayName);
        }else{
          search();
        }
      }else if(e.key==='Escape'){
        $drop.classList.remove('visible'); $input.setAttribute('aria-expanded','false');
      }
    });
    $btn.addEventListener('click', search);
  </script>
</body>
</html>















